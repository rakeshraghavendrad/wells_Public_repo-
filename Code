from pyspark.sql import SparkSession
from pyspark.sql.functions import col, when

# Assuming your DataFrame is named 'your_table'
spark = SparkSession.builder.appName("IPFlag").getOrCreate()

# Replace 'your_table' with your actual DataFrame name
your_table = spark.table("your_table")

# Add a new column 'flag' based on the condition
result_df = your_table.withColumn("flag", when(col("firstiplogin") == col("secondiplogin"), 1).otherwise(0))

# Show the result
result_df.show()
