import re
import pandas as pd

def extract_merchant_name(transaction_text):
    # Define a list of patterns to match common merchant name formats
    patterns = [
        r'AUTHORIZED ON \d{2}/\d{2}\s*([A-Z]+)\s*\d+',  # Matches "AUTHORIZED ON MM/DD MERCHANT 123"
        r'(\w+)\s*[\d\*-]+\s*[\w/\.]+',  # Matches alphanumeric patterns with possible hyphens and dots
    ]

    # Try to match each pattern and return the first match
    for pattern in patterns:
        match = re.search(pattern, transaction_text)
        if match:
            return match.group(1).strip()

    return None  # Return None if no match is found

# Example dataset
data = {
    'Transaction Text': [
        "PURCHASE AUTHORIZED ON 09/24 ABC Y 50 420 BOSTON P GULIFORD CT P09123543234567823 CARD 3412",
        "PURCHASE AUTHORIZED ON 08/24 CATR 55 490 TEXAS P GULIFORD CT P09123543234734132 CARD 7631",
        "PURCHASE AUTHORIZED ON 10/24 supermarket Halethorpe, Maryland ND P09123543234094512 CARD 9801",
        "MICROSOFT.COM/BILL 855-324-7985 CA",
        "ALL BANGLA SWEETS & RESTAAUSTIN TX",
        "AMZN MKTP US*9G9903M2 AMAMZN.com/BILLWA"
    ]
}

# Create a DataFrame
df = pd.DataFrame(data)

# Apply the extract_merchant_name function to create a new column 'Merchant Name'
df['Merchant Name'] = df['Transaction Text'].apply(extract_merchant_name)

# Display the result
print(df[['Transaction Text', 'Merchant Name']])
