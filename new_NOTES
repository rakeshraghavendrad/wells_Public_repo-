
# Extract 'transactionId' from 'transactionDetails' for each doc
tx_ids = [
    doc['transactionDetails']['transactionId']
    for doc in docs
    if 'transactionDetails' in doc and 'transactionId' in doc['transactionDetails']
]

# Count of unique transaction IDs
unique_tx_cnt = len(set(tx_ids))
unique_tx_cnt




#
from datetime import datetime

start_date = datetime(2025, 5, 25)
end_date = datetime(2025, 5, 26)  # exclusive upper bound

query = {
    "eventName": "IDV_REPORTING_REQUEST",
    "createdDate": {
        "$gte": start_date,
        "$lt": end_date






Min createdDate
min_doc = collection.find().sort("createdDate", 1).limit(1)[0]["createdDate"]

# Max createdDate
max_doc = collection.find().sort("createdDate", -1).limit(1)[0]["createdDate"]

print("Min createdDate:", min_doc)
print("Max createdDate:", max_doc)
