from pyspark.sql import SparkSession
from pyspark.sql.functions import col
import matplotlib.pyplot as plt

# Step 1: Collect data from PySpark DataFrame
data = nsc.orderBy(col("frequency_count").desc()).limit(50).collect()  # Limiting to top 50 for better visualization

# Step 2: Extract shortforms and frequencies
short_forms = [row["short_form"] for row in data]
frequencies = [row["frequency_count"] for row in data]

# Step 3: Plot bar chart
plt.figure(figsize=(12, 6))
plt.bar(short_forms, frequencies, color="skyblue")

# Step 4: Formatting the chart
plt.xlabel("Short Forms")
plt.ylabel("Frequency Count")
plt.title("Frequency Distribution of Short Forms")
plt.xticks(rotation=90)  # Rotate x-axis labels for better readability

# Step 5: Show the plot
plt.show()
