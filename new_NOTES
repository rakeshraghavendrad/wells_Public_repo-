### Percentile-Based Method ###
def find_percentile_threshold(nsc_df, percentile=25):
    threshold = nsc_df.agg(percentile_approx("frequency_count", percentile / 100.0)).collect()[0][0]
    return threshold

# Call the functions
elbow_threshold = find_elbow_point(nsc)
percentile_threshold = find_percentile_threshold(nsc, percentile=25)

# Filter the DataFrame based on both thresholds
nsc_filtered_elbow = nsc.filter(col("frequency_count") >= elbow_threshold)
nsc_filtered_percentile = nsc.filter(col("frequency_count") >= percentile_threshold)

# Show results
print(f"Elbow Method Cutoff: {elbow_threshold}")
print(f"Percentile (25%) Cutoff: {percentile_threshold}")

nsc_filtered_elbow.show()
nsc_filtered_percentile.show()
