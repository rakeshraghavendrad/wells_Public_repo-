from pyspark.sql import SparkSession
from pyspark.sql.functions import col
import numpy as np
import matplotlib.pyplot as plt

# Assuming SparkSession is already created
# spark = SparkSession.builder.appName("LineGraph").getOrCreate()

# Step 1: Sort the data by frequency_count in descending order
nsc_sorted = nsc.orderBy(col("frequency_count").desc())

# Step 2: Collect the sorted data
data = nsc_sorted.select("short_form", "frequency_count").collect()

# Step 3: Extract values for plotting
short_forms = [row["short_form"] for row in data]
frequencies = [row["frequency_count"] for row in data]

# Step 4: Plot the line graph
plt.figure(figsize=(10, 5))
plt.plot(range(len(frequencies)), frequencies, marker="o", linestyle="-", markersize=2, label="Frequency Count")

# Step 5: Formatting the plot
plt.xlabel("Ranked Shortforms")
plt.ylabel("Frequency Count")
plt.title("Frequency Distribution of Shortforms")
plt.legend()
plt.grid()

# Show the plot
plt.show()
