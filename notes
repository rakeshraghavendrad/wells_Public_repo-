from pyspark.sql import SparkSession

# Initialize a Spark session
spark = SparkSession.builder.appName("RenameColumns").getOrCreate()

# Create a sample DataFrame
data = [(1, 2, 3), (4, 5, 6), (7, 8, 9)]
columns = ["col1", "col2", "col3"]
df = spark.createDataFrame(data, columns)

# Print the original DataFrame schema
print("Original schema:")
df.printSchema()

# List of columns to rename
columns_to_rename = ["col1", "col2", "col3"]

# Loop to rename columns
for col in columns_to_rename:
    df = df.withColumnRenamed(col, f"{col}_dw")

# Print the modified DataFrame schema
print("Modified schema:")
df.printSchema()
