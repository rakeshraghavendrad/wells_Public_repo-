from pyspark.sql import SparkSession
from datetime import datetime
from dateutil.relativedelta import relativedelta

# Initialize Spark session
spark = SparkSession.builder \
    .appName("Date Range Calculation") \
    .getOrCreate()

# Current date
current_date = datetime.now()

# Calculate start date (first day of the month one year before the current month)
start_date = (datetime(current_date.year, current_date.month, 1) - relativedelta(months=12))
start_date_str = start_date.strftime('%Y-%m-%d')

# Calculate end date (first day of the current month)
end_date = datetime(current_date.year, current_date.month, 1)
end_date_str = end_date.strftime('%Y-%m-%d')

print("Start Date:", start_date_str)
print("End Date:", end_date_str)
