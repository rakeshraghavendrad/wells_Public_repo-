import pandas as pd
from sklearn.feature_extraction.text import CountVectorizer
from sklearn.metrics.pairwise import cosine_similarity

# Sample data
data = {
    'fullname.30': ['John Doe', 'Jane Smith', 'Alice Johnson'],
    'fullname.90': ['Johnathan Doe', 'Jane S. Smith', 'A. Johnson']
}

# Create a DataFrame
df = pd.DataFrame(data)

# Initialize CountVectorizer
vectorizer = CountVectorizer()

# Fit and transform the text data for both columns
vector_30 = vectorizer.fit_transform(df['fullname.30'])
vector_90 = vectorizer.transform(df['fullname.90'])

# Calculate the cosine similarity between the vectors
cosine_sim = cosine_similarity(vector_30, vector_90)

# Add the cosine similarity values to the DataFrame
df['cosine_similarity'] = [cosine_sim[i, i] for i in range(len(df))]

# Show the DataFrame
print(df)

