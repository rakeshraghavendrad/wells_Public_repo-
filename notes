Here's a more polished version:

"I have reviewed the ingested marketing data and conducted an analysis. 

From a column perspective, all the necessary fields to calculate the marketing response are available, so weâ€™re covered on that front.

Looking at the data, I observed that 1.3% of responses are from email campaigns and 0.2% from banners. If we are comfortable with this deviation, I believe the marketing data is in good shape."




https://towardsdatascience.com/graph-rag-a-conceptual-introduction-41cd0d431375


from pyspark.sql import functions as F
from pyspark.sql.types import StringType
from fuzzywuzzy import fuzz

# UDF for fuzzy matching
def fuzzy_match(name1, name2):
    return fuzz.ratio(name1, name2)

fuzzy_udf = F.udf(fuzzy_match, StringType())

# Normalizing input: Removing spaces between letters
input_first_name = "John"
input_middle_name = "Doe"

input_first_name_normalized = F.regexp_replace(input_first_name, "\\s+", "")
input_middle_name_normalized = F.regexp_replace(input_middle_name, "\\s+", "")

# Fuzzy matching with swapped names and spaces removed
matched_data = spark_df.filter(
    (fuzzy_udf(F.col('first_name'), input_first_name_normalized) >= 80) & 
    (fuzzy_udf(F.col('middle_name'), input_middle_name_normalized) >= 80) |
    (fuzzy_udf(F.col('first_name'), input_middle_name_normalized) >= 80) & 
    (fuzzy_udf(F.col('middle_name'), input_first_name_normalized) >= 80)
)

matched_data.show()

