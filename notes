from pyspark.sql.window import Window
from pyspark.sql.functions import row_number


# Sample DataFrame
data = [("John", 25), ("Alice", 30), ("Bob", 35)]
columns = ["Name", "Age"]
df = spark.createDataFrame(data, columns)

# Add index
windowSpec = Window.orderBy("Name")  # Define window specification
df = df.withColumn("Index", row_number().over(windowSpec))

# Show DataFrame with index
df.show()
