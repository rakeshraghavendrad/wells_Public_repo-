from pyspark.sql.functions import avg

# Group by 'rate_bucket' and calculate the average response score for each bucket
avg_response_score = df_with_buckets.groupBy("rate_bucket").agg(avg("response_score").alias("avg_response_score"))

# Show the average response score for each bucket
avg_response_score.show()
