from pyspark.sql.functions import count

# Assuming merged_df is your DataFrame after the inner join

# Create a pivot table-like DataFrame
pivot_table = merged_df.groupBy('c1').pivot('c2').agg(count('*')).fillna(0)

# Convert to Pandas DataFrame for visualization
pivot_table_pd = pivot_table.toPandas()

# Create the heatmap using Seaborn
plt.figure(figsize=(10, 8))
sns.heatmap(pivot_table_pd.set_index('c1'), cmap='YlGnBu', linewidths=0.5, linecolor='grey')
plt.title('Heatmap of Common Elements between c1 and c2')
plt.xlabel('c2 values')
plt.ylabel('c1 values')
plt.show()

