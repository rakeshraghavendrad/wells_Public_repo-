from pyspark.sql import SparkSession
from pyspark.sql.functions import col, expr
from datetime import datetime, timedelta

# Initialize Spark session
spark = SparkSession.builder \
    .appName("Date Range Calculation") \
    .getOrCreate()

# Current date
current_date = datetime.now()

# Calculate start date (1 year before the first day of the current month)
start_date = datetime(current_date.year, current_date.month, 1) - timedelta(days=365)
# Calculate end date (last day of the current month)
end_date = datetime(current_date.year, current_date.month + 1, 1) - timedelta(days=1)

# Create a DataFrame with the start and end dates
data = [(start_date, end_date)]
df = spark.createDataFrame(data, ["start_date", "end_date"])

# Show the DataFrame
df.show()
